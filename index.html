<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Cluster Viewer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Image Cluster Viewer</h1>
        </header>

        <div class="top-panels">
            <div class="upload-section">
                <h2>Upload CSV File</h2>
                <p>Select a CSV file with columns "local_path" (path to image) and "component" (cluster ID)</p>

                <div class="file-input-row">
                    <div class="file-input-container">
                        <input type="file" id="csvFile" accept=".csv">
                    </div>
                    <div class="path-prefix-container">
                        <label for="pathPrefix">Path Prefix:</label>
                        <input type="text" id="pathPrefix" placeholder="e.g. /mnt/coreflow/data">
                        <span class="help-text">Base path for images</span>
                    </div>
                </div>
            </div>

            <div class="stats-section" id="statsSection" style="display: none;">
                <h2>Cluster Statistics</h2>
                <p id="totalClusters">Total clusters: 0</p>
                <p id="totalImages">Total images: 0</p>
            </div>
        </div>

        <div class="controls-section" id="controlsSection" style="display: none;">
            <div class="navigation-controls">
                <div class="page-navigation">
                    <button id="prevBtn" class="nav-btn"><</button>
                    <span id="pageInfo">Page 1 of 1</span>
                    <button id="nextBtn" class="nav-btn">></button>
                </div>
            </div>

            <div class="controls-row">
                <div class="display-controls">
                    <label for="thumbnailSize">Thumbnail Size:</label>
                    <input type="range" id="thumbnailSize" min="50" max="420" value="170" step="10">
                    <span id="sizeValue">170px</span>
                </div>

                <div class="query-controls">
                    <label for="queryInput">query:</label>
                    <input type="text" id="queryInput" placeholder="e.g. bucket < 15">
                    <button id="applyQueryBtn">Mark</button>
                    <button id="filterClustersBtn">Filter Clusters</button>
                    <button id="clearQueryBtn">Clear</button>
                    <span id="queryMatchCount" class="query-match-count-label"></span>
                </div>
            </div>

            <div class="controls-row">
                <div class="verification-controls">
                    <button id="exportCsvBtn" class="export-btn">Export Verified CSV</button>
                    <span class="verification-info">Create verified clusters by selecting images in zoom-in mode</span>
                </div>
            </div>

            <div class="query-help">
                <p>Examples: "bucket < 15", "condition == 'melanoma'", etc.</p>
            </div>
        </div>

        <div class="clusters-container" id="clustersContainer">
            <!-- Clusters will be displayed here -->
        </div>
    </div>

    <!-- Load JavaScript -->
    <script src="script.js"></script>
</body>
</html>